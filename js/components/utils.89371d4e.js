export function escapeHTML(e){return"string"!=typeof e?"":e.replace(/[&<>"'`=\/]/g,e=>{switch(e){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&#039;";case"`":return"&#096;";case"=":return"&#x3D;";case"/":return"&#x2F;";default:return e}})}const allowed_filters=new Set(["q","page","genres","min_score","max_score","status","type","rating","order_by","sort"]),ENUMS={status:new Set(["airing","complete","upcoming"]),type:new Set(["tv","movie","ova","special"]),rating:new Set(["g","pg","pg13","r","r17","rx"]),order_by:new Set(["title","score","popularity","favorites"]),sort:new Set(["asc","desc"])};export function getSafeParams(){const e=new URLSearchParams(window.location.hash.split("?")[1]||""),t=new URLSearchParams;for(const[r,s]of e.entries())if(allowed_filters.has(r))if("q"===r){const e=s.replace(/[^\p{L}\p{N}\s\-_.:'";|#]/gu,"").slice(0,100);t.set("q",e)}else if(["min_score","max_score"].includes(r)){const e=parseInt(s,10);Number.isFinite(e)&&e>=0&&e<=10&&t.set(r,String(e))}else if("page"===r){const e=parseInt(s,10);Number.isFinite(e)&&e>=1&&e<=1e3&&t.set(r,String(e))}else if("genres"===r){const e=s.split(",").map(e=>parseInt(e,10)).filter(e=>Number.isFinite(e)&&e>0);e.length&&t.set("genres",e.join(","))}else if(ENUMS[r]){const e=s.toLowerCase();ENUMS[r].has(e)&&t.set(r,e)}return t}